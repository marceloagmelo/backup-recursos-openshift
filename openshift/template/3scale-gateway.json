{"kind":"Template","apiVersion":"template.openshift.io/v1","metadata":{"name":"3scale-gateway","namespace":"openshift","selfLink":"/apis/template.openshift.io/v1/namespaces/openshift/templates/3scale-gateway","uid":"aae8304a-a715-11e9-9411-42010a9e0002","resourceVersion":"1378","creationTimestamp":"2019-07-15T15:31:51Z","annotations":{"description":"3scale API Gateway","iconClass":"icon-load-balancer","tags":"api,gateway,3scale"}},"objects":[{"apiVersion":"v1","kind":"DeploymentConfig","metadata":{"name":"${APICAST_NAME}"},"spec":{"replicas":2,"selector":{"deploymentconfig":"${APICAST_NAME}"},"strategy":{"type":"Rolling"},"template":{"metadata":{"labels":{"deploymentconfig":"${APICAST_NAME}"}},"spec":{"containers":[{"env":[{"name":"THREESCALE_PORTAL_ENDPOINT","valueFrom":{"secretKeyRef":{"key":"password","name":"${CONFIGURATION_URL_SECRET}"}}},{"name":"THREESCALE_CONFIG_FILE","value":"${CONFIGURATION_FILE_PATH}"},{"name":"THREESCALE_DEPLOYMENT_ENV","value":"${DEPLOYMENT_ENVIRONMENT}"},{"name":"RESOLVER","value":"${RESOLVER}"},{"name":"APICAST_SERVICES","value":"${SERVICES_LIST}"},{"name":"APICAST_CONFIGURATION_LOADER","value":"${CONFIGURATION_LOADER}"},{"name":"APICAST_LOG_LEVEL","value":"${LOG_LEVEL}"},{"name":"APICAST_PATH_ROUTING_ENABLED","value":"${PATH_ROUTING}"},{"name":"APICAST_RESPONSE_CODES","value":"${RESPONSE_CODES}"},{"name":"APICAST_CONFIGURATION_CACHE","value":"${CONFIGURATION_CACHE}"},{"name":"REDIS_URL","value":"${REDIS_URL}"},{"name":"APICAST_MANAGEMENT_API","value":"${MANAGEMENT_API}"},{"name":"OPENSSL_VERIFY","value":"${OPENSSL_VERIFY}"}],"image":"3scale-amp20/apicast-gateway:1.0-3","imagePullPolicy":"IfNotPresent","livenessProbe":{"httpGet":{"path":"/status/live","port":"management"},"initialDelaySeconds":10,"timeoutSeconds":1},"name":"${APICAST_NAME}","ports":[{"containerPort":8080,"name":"proxy","protocol":"TCP"},{"containerPort":8090,"name":"management","protocol":"TCP"}],"readinessProbe":{"httpGet":{"path":"/status/ready","port":"management"},"initialDelaySeconds":15,"timeoutSeconds":1}}]}},"triggers":[{"type":"ConfigChange"}]}},{"apiVersion":"v1","kind":"Service","metadata":{"name":"${APICAST_NAME}"},"spec":{"ports":[{"name":"proxy","port":8080,"protocol":"TCP","targetPort":8080},{"name":"management","port":8090,"protocol":"TCP","targetPort":8090}],"selector":{"deploymentconfig":"${APICAST_NAME}"}}}],"parameters":[{"name":"AMP_RELEASE","description":"AMP release tag.","value":"2.0.0-CR2-redhat-1","required":true},{"name":"CONFIGURATION_URL_SECRET","description":"Name of the secret containing the THREESCALE_PORTAL_ENDPOINT with the access-token or provider key","value":"apicast-configuration-url-secret","required":true},{"name":"CONFIGURATION_FILE_PATH","description":"Path to saved JSON file with configuration for the gateway. Has to be injected to the docker image as read only volume."},{"name":"DEPLOYMENT_ENVIRONMENT","description":"Deployment environment. Can be sandbox or production.","value":"production","required":true},{"name":"APICAST_NAME","description":"Name for the 3scale API Gateway","value":"apicast","required":true},{"name":"RESOLVER","description":"DNS Resolver for openresty, if empty it will be autodiscovered"},{"name":"SERVICES_LIST","description":"Subset of services to run. Use comma separated list of service ids (eg. 42,1337)"},{"name":"CONFIGURATION_LOADER","description":"When to load configuration. If on gateway start or incoming request. Allowed values are: lazy, boot.","value":"boot"},{"name":"LOG_LEVEL","description":"Log level. One of the following: debug, info, notice, warn, error, crit, alert, or emerg."},{"name":"PATH_ROUTING","description":"Enable path routing. Experimental feature.","value":"false"},{"name":"RESPONSE_CODES","description":"Enable logging response codes to 3scale.","value":"false"},{"name":"CONFIGURATION_CACHE","description":"For how long to cache the downloaded configuration in seconds. Can be left empty, 0 or greater than 60."},{"name":"REDIS_URL","description":"Redis URL. Required for OAuth2 integration. ex: redis://PASSWORD@127.0.0.1:6379/0"},{"name":"MANAGEMENT_API","description":"Scope of the Management API. Can be disabled, status or debug. At least status required for health checks.","value":"status"},{"name":"OPENSSL_VERIFY","description":"Turn on/off the OpenSSL peer verification. Can be set to true/false.","value":"false","required":true}]}
