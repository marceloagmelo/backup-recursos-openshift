{"kind":"Template","apiVersion":"template.openshift.io/v1","metadata":{"name":"django-psql-example","namespace":"openshift","selfLink":"/apis/template.openshift.io/v1/namespaces/openshift/templates/django-psql-example","uid":"b94da256-b867-11e9-993c-080027321238","resourceVersion":"873","creationTimestamp":"2019-08-06T16:32:04Z","annotations":{"description":"An example Django application with a PostgreSQL database. For more information about using this template, including OpenShift considerations, see https://github.com/openshift/django-ex/blob/master/README.md.\n\nWARNING: Any data stored will be lost upon pod destruction. Only use this template for testing.","iconClass":"icon-python","openshift.io/display-name":"Django + PostgreSQL (Ephemeral)","openshift.io/documentation-url":"https://github.com/openshift/django-ex","openshift.io/long-description":"This template defines resources needed to develop a Django based application, including a build configuration, application deployment configuration, and database deployment configuration.  The database is stored in non-persistent storage, so this configuration should be used for experimental purposes only.","openshift.io/provider-display-name":"Red Hat, Inc.","openshift.io/support-url":"https://access.redhat.com","tags":"quickstart,python,django","template.openshift.io/bindable":"false"}},"message":"The following service(s) have been created in your project: ${NAME}, ${DATABASE_SERVICE_NAME}.\n\nFor more information about using this template, including OpenShift considerations, see https://github.com/openshift/django-ex/blob/master/README.md.","objects":[{"apiVersion":"v1","kind":"Secret","metadata":{"name":"${NAME}"},"stringData":{"database-password":"${DATABASE_PASSWORD}","database-user":"${DATABASE_USER}","django-secret-key":"${DJANGO_SECRET_KEY}"}},{"apiVersion":"v1","kind":"Service","metadata":{"annotations":{"description":"Exposes and load balances the application pods","service.alpha.openshift.io/dependencies":"[{\"name\": \"${DATABASE_SERVICE_NAME}\", \"kind\": \"Service\"}]"},"name":"${NAME}"},"spec":{"ports":[{"name":"web","port":8080,"targetPort":8080}],"selector":{"name":"${NAME}"}}},{"apiVersion":"v1","kind":"Route","metadata":{"name":"${NAME}"},"spec":{"host":"${APPLICATION_DOMAIN}","to":{"kind":"Service","name":"${NAME}"}}},{"apiVersion":"v1","kind":"ImageStream","metadata":{"annotations":{"description":"Keeps track of changes in the application image"},"name":"${NAME}"}},{"apiVersion":"v1","kind":"BuildConfig","metadata":{"annotations":{"description":"Defines how to build the application","template.alpha.openshift.io/wait-for-ready":"true"},"name":"${NAME}"},"spec":{"output":{"to":{"kind":"ImageStreamTag","name":"${NAME}:latest"}},"postCommit":{"script":"./manage.py test"},"source":{"contextDir":"${CONTEXT_DIR}","git":{"ref":"${SOURCE_REPOSITORY_REF}","uri":"${SOURCE_REPOSITORY_URL}"},"type":"Git"},"strategy":{"sourceStrategy":{"env":[{"name":"PIP_INDEX_URL","value":"${PIP_INDEX_URL}"}],"from":{"kind":"ImageStreamTag","name":"python:3.5","namespace":"${NAMESPACE}"}},"type":"Source"},"triggers":[{"type":"ImageChange"},{"type":"ConfigChange"},{"github":{"secret":"${GITHUB_WEBHOOK_SECRET}"},"type":"GitHub"}]}},{"apiVersion":"v1","kind":"DeploymentConfig","metadata":{"annotations":{"description":"Defines how to deploy the application server","template.alpha.openshift.io/wait-for-ready":"true"},"name":"${NAME}"},"spec":{"replicas":1,"selector":{"name":"${NAME}"},"strategy":{"type":"Recreate"},"template":{"metadata":{"labels":{"name":"${NAME}"},"name":"${NAME}"},"spec":{"containers":[{"env":[{"name":"DATABASE_SERVICE_NAME","value":"${DATABASE_SERVICE_NAME}"},{"name":"DATABASE_ENGINE","value":"${DATABASE_ENGINE}"},{"name":"DATABASE_NAME","value":"${DATABASE_NAME}"},{"name":"DATABASE_USER","valueFrom":{"secretKeyRef":{"key":"database-user","name":"${NAME}"}}},{"name":"DATABASE_PASSWORD","valueFrom":{"secretKeyRef":{"key":"database-password","name":"${NAME}"}}},{"name":"APP_CONFIG","value":"${APP_CONFIG}"},{"name":"DJANGO_SECRET_KEY","valueFrom":{"secretKeyRef":{"key":"django-secret-key","name":"${NAME}"}}}],"image":" ","livenessProbe":{"httpGet":{"path":"/health","port":8080},"initialDelaySeconds":30,"timeoutSeconds":3},"name":"django-psql-example","ports":[{"containerPort":8080}],"readinessProbe":{"httpGet":{"path":"/health","port":8080},"initialDelaySeconds":3,"timeoutSeconds":3},"resources":{"limits":{"memory":"${MEMORY_LIMIT}"}}}]}},"triggers":[{"imageChangeParams":{"automatic":true,"containerNames":["django-psql-example"],"from":{"kind":"ImageStreamTag","name":"${NAME}:latest"}},"type":"ImageChange"},{"type":"ConfigChange"}]}},{"apiVersion":"v1","kind":"Service","metadata":{"annotations":{"description":"Exposes the database server"},"name":"${DATABASE_SERVICE_NAME}"},"spec":{"ports":[{"name":"postgresql","port":5432,"targetPort":5432}],"selector":{"name":"${DATABASE_SERVICE_NAME}"}}},{"apiVersion":"v1","kind":"DeploymentConfig","metadata":{"annotations":{"description":"Defines how to deploy the database","template.alpha.openshift.io/wait-for-ready":"true"},"name":"${DATABASE_SERVICE_NAME}"},"spec":{"replicas":1,"selector":{"name":"${DATABASE_SERVICE_NAME}"},"strategy":{"type":"Recreate"},"template":{"metadata":{"labels":{"name":"${DATABASE_SERVICE_NAME}"},"name":"${DATABASE_SERVICE_NAME}"},"spec":{"containers":[{"env":[{"name":"POSTGRESQL_USER","valueFrom":{"secretKeyRef":{"key":"database-user","name":"${NAME}"}}},{"name":"POSTGRESQL_PASSWORD","valueFrom":{"secretKeyRef":{"key":"database-password","name":"${NAME}"}}},{"name":"POSTGRESQL_DATABASE","value":"${DATABASE_NAME}"}],"image":" ","livenessProbe":{"initialDelaySeconds":30,"tcpSocket":{"port":5432},"timeoutSeconds":1},"name":"postgresql","ports":[{"containerPort":5432}],"readinessProbe":{"exec":{"command":["/bin/sh","-i","-c","psql -h 127.0.0.1 -U ${POSTGRESQL_USER} -q -d ${POSTGRESQL_DATABASE} -c 'SELECT 1'"]},"initialDelaySeconds":5,"timeoutSeconds":1},"resources":{"limits":{"memory":"${MEMORY_POSTGRESQL_LIMIT}"}},"volumeMounts":[{"mountPath":"/var/lib/pgsql/data","name":"data"}]}],"volumes":[{"emptyDir":{},"name":"data"}]}},"triggers":[{"imageChangeParams":{"automatic":true,"containerNames":["postgresql"],"from":{"kind":"ImageStreamTag","name":"postgresql:9.5","namespace":"${NAMESPACE}"}},"type":"ImageChange"},{"type":"ConfigChange"}]}}],"parameters":[{"name":"NAME","displayName":"Name","description":"The name assigned to all of the frontend objects defined in this template.","value":"django-psql-example","required":true},{"name":"NAMESPACE","displayName":"Namespace","description":"The OpenShift Namespace where the ImageStream resides.","value":"openshift","required":true},{"name":"MEMORY_LIMIT","displayName":"Memory Limit","description":"Maximum amount of memory the Django container can use.","value":"512Mi","required":true},{"name":"MEMORY_POSTGRESQL_LIMIT","displayName":"Memory Limit (PostgreSQL)","description":"Maximum amount of memory the PostgreSQL container can use.","value":"512Mi","required":true},{"name":"SOURCE_REPOSITORY_URL","displayName":"Git Repository URL","description":"The URL of the repository with your application source code.","value":"https://github.com/openshift/django-ex.git","required":true},{"name":"SOURCE_REPOSITORY_REF","displayName":"Git Reference","description":"Set this to a branch name, tag or other ref of your repository if you are not using the default branch."},{"name":"CONTEXT_DIR","displayName":"Context Directory","description":"Set this to the relative path to your project if it is not in the root of your repository."},{"name":"APPLICATION_DOMAIN","displayName":"Application Hostname","description":"The exposed hostname that will route to the Django service, if left blank a value will be defaulted."},{"name":"GITHUB_WEBHOOK_SECRET","displayName":"GitHub Webhook Secret","description":"Github trigger secret.  A difficult to guess string encoded as part of the webhook URL.  Not encrypted.","generate":"expression","from":"[a-zA-Z0-9]{40}"},{"name":"DATABASE_SERVICE_NAME","displayName":"Database Service Name","value":"postgresql","required":true},{"name":"DATABASE_ENGINE","displayName":"Database Engine","description":"Database engine: postgresql, mysql or sqlite (default).","value":"postgresql","required":true},{"name":"DATABASE_NAME","displayName":"Database Name","value":"default","required":true},{"name":"DATABASE_USER","displayName":"Database Username","value":"django","required":true},{"name":"DATABASE_PASSWORD","displayName":"Database User Password","generate":"expression","from":"[a-zA-Z0-9]{16}"},{"name":"APP_CONFIG","displayName":"Application Configuration File Path","description":"Relative path to Gunicorn configuration file (optional)."},{"name":"DJANGO_SECRET_KEY","displayName":"Django Secret Key","description":"Set this to a long random string.","generate":"expression","from":"[\\w]{50}"},{"name":"PIP_INDEX_URL","displayName":"Custom PyPi Index URL","description":"The custom PyPi index URL"}],"labels":{"app":"django-psql-example","template":"django-psql-example"}}
